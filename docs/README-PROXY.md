# Super Proxy - é€æ˜Žä»£ç†ç›‘ç£å™¨

## æž¶æž„æ¦‚è¿°

```
ç”¨æˆ·ç»ˆç«¯ â†â†’ [Super Proxy] â†â†’ Claude Code CLI
                â†“
           Supervisor
           (æš—ä¸­ç›‘ç£)
```

## æ ¸å¿ƒç‰¹æ€§

### âœ… å®Œå…¨é€æ˜Ž
- **ä¿ç•™ Claude åŽŸç”Ÿä½“éªŒ**ï¼šæ‰€æœ‰åŠ¨ç”»ã€é«˜äº®ã€äº¤äº’åŠŸèƒ½å®Œå…¨ä¿ç•™
- **åŒå‘ç®¡é“**ï¼šç”¨æˆ·è¾“å…¥å’Œ Claude è¾“å‡ºç›´æŽ¥ä¼ é€’ï¼Œæ— ä¿®æ”¹
- **æ— ç•Œé¢æ±¡æŸ“**ï¼šæ²¡æœ‰ [Supervisor] ç­‰æ ‡è®°ï¼Œç”¨æˆ·çœ‹ä¸åˆ°ç›‘ç£ç—•è¿¹

### ðŸ” æš—ä¸­ç›‘ç£
- **åŽå°åˆ†æž**ï¼šSupervisor ç›‘å¬æ‰€æœ‰äº¤äº’ä½†ä¸å½±å“æ˜¾ç¤º
- **å…³é”®è¯æ£€æµ‹**ï¼šæ£€æµ‹ "done"ã€"complete" ç­‰å®Œæˆå£°æ˜Ž
- **è‡ªåŠ¨éªŒè¯**ï¼šè§¦å‘ `./verify.sh` è¿›è¡Œæµ‹è¯•éªŒè¯

### ðŸ’‰ æ™ºèƒ½æ³¨å…¥
- **è‡ªç„¶æ‰“å­—**ï¼šé€å­—ç¬¦æ³¨å…¥ï¼Œæ¨¡æ‹ŸçœŸå®žç”¨æˆ·è¾“å…¥
- **éšæœºå»¶è¿Ÿ**ï¼š50-150ms éšæœºé—´éš”ï¼Œæ›´åƒäººç±»æ‰“å­—
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šæ ¹æ®å¤±è´¥ç±»åž‹ç”Ÿæˆåˆé€‚çš„è¯¢é—®

## æ–‡ä»¶è¯´æ˜Ž

```
super-proxy.js      # ä¸»ç¨‹åº - é€æ˜Žä»£ç†
mock-claude.js      # æ¨¡æ‹Ÿå™¨ - ç”¨äºŽæµ‹è¯•
test-proxy.js       # è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
demo-proxy.sh       # æ¼”ç¤ºè„šæœ¬
```

## ä½¿ç”¨æ–¹æ³•

### 1. ä½¿ç”¨çœŸå®ž Claude
```bash
node super-proxy.js
# æˆ–
./super-proxy.js
```

### 2. ä½¿ç”¨æ¨¡æ‹Ÿå™¨æµ‹è¯•
```bash
node super-proxy.js --mock
```

### 3. è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
```bash
node test-proxy.js
```

## å·¥ä½œæµç¨‹

1. **ç”¨æˆ·è¾“å…¥** â†’ Super Proxy â†’ Claude
2. **Claude å“åº”** â†’ Super Proxy â†’ ç”¨æˆ·ï¼ˆåŒæ—¶ Supervisor åˆ†æžï¼‰
3. **æ£€æµ‹åˆ° "done"** â†’ å»¶è¿Ÿ 3 ç§’ â†’ è¿è¡Œ verify.sh
4. **æµ‹è¯•å¤±è´¥** â†’ å»¶è¿Ÿ 2 ç§’ â†’ æ³¨å…¥è‡ªç„¶è¯¢é—®
5. **è¯¢é—®çœ‹èµ·æ¥åƒç”¨æˆ·è¾“å…¥** â†’ Claude å“åº”

## æ—¥å¿—æ–‡ä»¶

æ‰€æœ‰ç›‘ç£æ´»åŠ¨è®°å½•åœ¨ï¼š
```
.super/proxy-supervisor.log
```

æ—¥å¿—æ ¼å¼ï¼š
- `[OUTPUT]` - Claude çš„è¾“å‡º
- `[USER]` - ç”¨æˆ·çš„è¾“å…¥
- `[TRIGGER]` - æ£€æµ‹åˆ°å®Œæˆå£°æ˜Ž
- `[VERIFY]` - éªŒè¯ç»“æžœ
- `[INJECT]` - æ³¨å…¥çš„è¯¢é—®

## æŠ€æœ¯ç»†èŠ‚

### node-pty çš„å…³é”®ç”¨æ³•
```javascript
// åˆ›å»ºä¼ªç»ˆç«¯
const claude = pty.spawn('claude', [], {
    name: 'xterm-256color',
    cols: process.stdout.columns,
    rows: process.stdout.rows
});

// é€æ˜Žç®¡é“
process.stdin.pipe(claude);    // ç”¨æˆ· â†’ Claude
claude.pipe(process.stdout);   // Claude â†’ ç”¨æˆ·

// åŒæ—¶ç›‘å¬ï¼ˆä¸å½±å“ç®¡é“ï¼‰
claude.on('data', (data) => {
    supervisorAnalyze(data);  // æš—ä¸­åˆ†æž
});
```

### è‡ªç„¶æ³¨å…¥æŠ€æœ¯
```javascript
function injectInquiry(text) {
    let index = 0;
    const typeChar = () => {
        if (index < text.length) {
            claude.write(text[index]);
            index++;
            // éšæœºæ‰“å­—é€Ÿåº¦
            setTimeout(typeChar, 50 + Math.random() * 100);
        } else {
            claude.write('\r');  // Enter
        }
    };
    typeChar();
}
```

## ä¸Žä¹‹å‰æ–¹æ¡ˆçš„åŒºåˆ«

### âŒ ä¹‹å‰çš„é”™è¯¯ç†è§£
- åˆ›å»ºäº†æ–°çš„ç•Œé¢
- æœ‰ Worker/Supervisor åˆ†ç¦»æ˜¾ç¤º
- ä¿®æ”¹äº† Claude çš„è¾“å‡º

### âœ… çŽ°åœ¨çš„æ­£ç¡®å®žçŽ°
- ä¸åˆ›å»ºä»»ä½•æ–°ç•Œé¢
- å®Œå…¨ä¿ç•™ Claude åŽŸç”Ÿä½“éªŒ
- Supervisor å®Œå…¨éšå½¢
- æ³¨å…¥çš„è¯¢é—®çœ‹èµ·æ¥åƒç”¨æˆ·è¾“å…¥

## æµ‹è¯•éªŒè¯

è¿è¡Œæµ‹è¯•è„šæœ¬ä¼šï¼š
1. å‘é€ "hello" - æ­£å¸¸äº¤äº’
2. å‘é€ "write a test" - ä»£ç ç”Ÿæˆ
3. å‘é€ "task done" - è§¦å‘éªŒè¯
4. è§‚å¯Ÿè‡ªåŠ¨æ³¨å…¥çš„è¯¢é—®ï¼ˆ"Can you check why the tests are failing?"ï¼‰
5. éªŒè¯æ•´ä¸ªæµç¨‹é€æ˜Žæ— ç—•

## æ³¨æ„äº‹é¡¹

- éœ€è¦ `node-pty` åŒ…æ¥åˆ›å»ºä¼ªç»ˆç«¯
- åœ¨ Windows ä¸Šå¯èƒ½éœ€è¦é¢å¤–é…ç½®
- Ctrl+C ç”¨äºŽé€€å‡ºä»£ç†
- ç¡®ä¿ `verify.sh` æœ‰æ‰§è¡Œæƒé™